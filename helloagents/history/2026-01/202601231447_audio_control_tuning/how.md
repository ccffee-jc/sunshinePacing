# 技术设计: 配置调参与音频轻量限制

## 技术方案
### 核心技术
- Go 标准库 net（UDP/TCP 监听与转发）
- 令牌桶 pacing（视频与音频）

### 实现要点
- 扩展音频配置，新增 rate_kbps/burst_kb/tick_ms 字段，用于轻量 pacing。
- 复用 pacing 逻辑为可配置速率（bps）与回调统计。
- Audio mode 为 limit/light 时启用轻量 pacing；control 保持直通。
- 更新 proxy.yml 示例配置与文档。

## 架构决策 ADR
### ADR-004: 音频轻量 pacing 使用独立令牌桶
**上下文:** 需要在不明显增加延迟的前提下平滑音频微突发。
**决策:** 音频使用独立 token-bucket pacing，并提供可配置速率。
**理由:** 控制粒度清晰，可独立调参且不影响 control/video。
**替代方案:** 音频直通不限制 → 拒绝原因: 无法满足轻量限制需求。
**影响:** 增加少量配置与运行开销。

## 安全与性能
- **安全:** 不记录敏感内容；仅对音频流进行轻量整形。
- **性能:** 音频 pacing 使用小队列与高限速，开销可控。

## 测试与部署
- **测试:** 运行 go test ./... 确认 pacing 与端口逻辑正常。
- **部署:** 更新 proxy.yml 后重新编译并启动。
